2000-07-26  Takaaki MORIYAMA <taka@airlab.cs.ritsumei.ac.jp>

	* elmo-archive.el (elmo-archive-get-archive-name): Fixed problem
	when dired is used on XEmacs.

2000-07-25  OKAZAKI Tetsurou  <okazaki@be.to>

	* elmo-imap4.el (elmo-imap4-process-folder-list): Use `nconc'
	instead of `append'.
	(elmo-imap4-commit): Use `elmo-imap4-plugged-p' instead of
	`elmo-plugged-p' directly.
	* elmo-pop3.el (elmo-pop3-commit): Use `elmo-pop3-plugged-p' instead
	of `elmo-plugged-p' directly.

	* elmo-pop3.el (elmo-pop3-get-connection): Split temporary variable.
	Eliminate unused variable.  Use `memq' for checking a process status.
	Use `cons' instead of `append' for updating the connection cache.
	* elmo-nntp.el (elmo-nntp-get-connection): Likewise.
	* elmo-imap4.el (elmo-imap4-get-connection): Likewise.

2000-07-22  OKAZAKI Tetsurou  <okazaki@be.to>

	* elmo-imap4.el (elmo-imap4-read-bytes): Advance
	`elmo-imap4-read-point' exactly.

	* mmelmo-imap4-2.el (mmelmo-imap4-get-mime-entity): Rename
	the local variable `folder' to `mailbox'.
	Rename the argument `fld' to `folder'.

2000-07-20  Kenichi OKADA <okada@opaopa.org>

	* elmo-pop3.el (elmo-pop3-commit): Do nothing when unplugged.
	* elmo-imap4.el (elmo-imap4-commit): Ditto.

2000-07-18  Yuuichi Teranishi  <teranisi@gohome.org>

	* elmo-pop3.el (elmo-pop3-use-uidl): New variable.
	(elmo-pop3-number-uidl-hash): New buffer-local variable.
	(elmo-pop3-uidl-number-hash): Ditto.
	(elmo-pop3-size-hash): Ditto.
	(elmo-pop3-uidl-done): Ditto.
	(elmo-pop3-list-done): Ditto.
	(elmo-pop3-connection-get-process): New defmacro.
	(elmo-pop3-connection-get-buffer): Ditto.
	(elmo-pop3-close-connection): Delete buffer and process.
	(elmo-pop3-flush-connection): Don't delete buffer and process.
	(elmo-pop3-get-connection): Added optional argument `if-exists'.
	Setup UIDL and size hash.
	(elmo-pop3-send-command-no-erase): Deleted
	(elmo-pop3-send-command): Added optional argument `no-erase'.
	(elmo-pop3-parse-uidl-response): New function.
	(elmo-pop3-parse-list-response): Set size hash.
	(elmo-pop3-list-location): New function.
	(elmo-pop3-list-by-uidl-subr): Ditto.
	(elmo-pop3-list-by-list): Ditto.
	(elmo-pop3-list-folder): Call `elmo-pop3-commit'.
	Call `elmo-pop3-list-by-uidl-subr' or `elmo-pop3-list-by-list'.
	(elmo-pop3-max-of-folder): Call `elmo-pop3-commit'.
	Call `elmo-pop3-list-by-uidl-subr' if `elmo-pop3-use-uidl' is non-nil.
	(elmo-pop3-msgdb-create-as-numlist): Added optional argument `msgdb'.
	Use uidl.
	(elmo-pop3-uidl-to-number): New function.
	(elmo-pop3-number-to-uidl): Ditto.
	(elmo-pop3-number-to-size): Ditto.
	(elmo-pop3-msgdb-create-by-header): Added argument `loc-alist'.
	Set number by use of uidl.
	(elmo-pop3-msgdb-create-message): Likewise.
	Set size, loc-alist in msgdb.
	(elmo-pop3-read-msg): Set number by use of uidl.
	Added optional argument `msgdb'.
	(elmo-pop3-delete-msg): Ditto.
	(elmo-pop3-delete-msgs): Added optional argument `msgdb'.
	(elmo-pop3-commit): Close connection.

	* elmo-pipe.el (elmo-pipe-max-of-folder):
	Bind `elmo-pop3-use-uidl' as nil.
	(elmo-pipe-drain): Ditto.
	Call `elmo-commit'.

	* elmo-msgdb.el (elmo-msgdb-delete-msgs): Delete location too.
	(elmo-msgdb-overview-entity-set-size): New defsubst.

2000-07-17  Yuuichi Teranishi  <teranisi@gohome.org>

	* elmo-vars.el (elmo-use-killed-list): New variable
	(Renamed from `elmo-nntp-use-killed-list').
	(elmo-nntp-use-killed-list): Eliminated.

	* elmo-msgdb.el (elmo-msgdb-expand-path):
	Changed expanding msgdb path for elmo-multi.

	* elmo-archive.el, elmo-cache.el, elmo-database.el, elmo-date.el,
	elmo-dop.el, elmo-filter.el, elmo-imap4.el, elmo-internal.el,
	elmo-localdir.el, elmo-localnews.el, elmo-maildir.el, elmo-msgdb.el,
	elmo-multi.el, elmo-nntp.el, elmo-pipe.el, elmo-pop3.el,
	elmo-util.el, elmo-vars.el, elmo2.el, mmelmo-1.el, mmelmo-2.el,
	mmelmo-imap4-1.el, mmelmo-imap4-2.el, mmelmo-imap4.el, mmelmo.el
	(toplevel): Deleted time-stamp line.

	* elmo2.el (elmo-clear-killed ): Defined as function
	(Abolished defining as a backend function).
	All other related modules are changed.

2000-07-14  Hiroshi Tsutsui <tsutsui@easter.kuee.kyoto-u.ac.jp>

	* elmo-cache.el (elmo-cache-clear-killed): Fixed.

2000-07-13  Yuuichi Teranishi  <teranisi@gohome.org>

	* elmo-msgdb.el (elmo-msgdb-append-to-killed-list): New function.

2000-07-12  Hiroya Murata  <lapis-lazuli@pop06.odn.ne.jp>

	* elmo-pop3.el (elmo-pop3-clear-killed): New alias.

2000-07-11  Yuuichi Teranishi  <teranisi@gohome.org>

	* elmo-nntp.el (elmo-nntp-max-of-folder): Use killed list in
	asynchronous folder check.

	* elmo2.el (elmo-move-msgs): Don't move message when buffer-size is 0.

	* elmo-nntp.el (elmo-nntp-delete-msgs): Check the value of
	`elmo-nntp-use-killed-list'.
	(elmo-nntp-list-folder): Use killed list.
	(elmo-nntp-max-of-folder): Ditto.
	(elmo-nntp-msgdb-create): Set killed list.

	* elmo-vars.el (elmo-nntp-use-killed-list): New user option.

	* elmo2.el (elmo-clear-killed): New backend function.
	All other related modules are changed.

2000-07-07  OKAZAKI Tetsurou  <okazaki@be.to>

	* elmo-util.el (elmo-imap4-spec-folder): Use
	`elmo-imap4-spec-mailbox'; Mark as obsolete.
	All callers changed.

2000-06-22  Yuuichi Teranishi  <teranisi@gohome.org>

	* mmelmo-2.el (initialize-instance):
	Use `mime-buffer-entity-buffer-internal' instead of
	`mime-entity-buffer'.

	* mmelmo-imap4-2.el (mmelmo-imap4-mime-entity-buffer): New function.
	(mime-entity-body): Implemented.
	(mime-goto-header-start-point): Deleted.
	(mime-goto-body-end-point): Ditto.
	(mime-entity-point-min): Ditto.
	(mime-entity-point-max): Ditto.
	(mime-entity-children): Ditto.
	(mime-insert-header): Use `mime-buffer-entity-buffer-internal'
	instead of `mime-entity-buffer'.
	(mime-entity-header-buffer): Ditto.
	(mime-entity-body-buffer): Ditto.
	(mime-write-entity-content): Ditto.

	* pldap.el (ldap-static-if): New macro.
	(toplevel): Use it instead of `static-if'.

2000-06-19  Yuuichi Teranishi  <teranisi@gohome.org>

	* pldap.el (ldap-search-basic): Don't collect 'dn' value even if it is
	included in `attrs' argument.

2000-06-16  Yuuichi Teranishi  <teranisi@gohome.org>

	* elmo-util.el (elmo-get-passwd): Use old backquote style.

	* pldap.el (ldap-ldif-safe-char-regexp): New constant.
	(ldap-ldif-safe-init-char-regexp): Ditto.
	(ldap-ldif-safe-string-regexp): Ditto.
	(ldap/ldif-safe-string-p): New macro.
	(ldap/ldif-insert-field): Ditto.
	(ldap-modify): Use it.
	(ldap-add): Ditto.
	(ldap-search-basic): Consider `attrsonly' also when `attrs' is nil.
	(ldap-decode-attribute): Decode only when `attr' is consp.
	(ldap-delete): Bind `ret'.
	(toplevel): Require 'cl at compile time.
	Removed (require 'poe) and (require 'std11).
	(pldap-version): Eliminated.
	(ldap-search-basic): Removed auth and dn binding.
	(ldap-ldif-field-name-regexp): New constant.
	(ldap-ldif-field-head-regexp): Ditto.
	(ldap-ldif-next-field-head-regexp): Ditto.
	(ldap/collect-field): Use `ldap-ldif-field-head-regexp'.
	(ldap/field-end): New function.
	(ldap/field-body): Use it.
	(ldap/collect-field): Ditto.
	(ldap-search-basic): Use `ldap/field-body'.

2000-06-15  Yuuichi Teranishi  <teranisi@gohome.org>

	* pldap.el (ldap-default-attribute-encoder): New user option.
	(ldap/field-body): Decode base64 string.
	(ldap/collect-field): Ditto.
	(ldap-encode-attribute): New function.
	(ldap-add-entries): Use it.
	(ldap-modify-entries): Ditto.
	(ldap-search-entries): Enclosed decoding function with
	`with-temp-buffer' and set as unibyte.
	(ldap-search-basic): Set process buffer as unibyte.

	* elmo-util.el (elmo-folder-identical-system-p):
	Eliminated name space checking.

	* pldap.el: New module.
	toplevel: Changed condition to detect built-in ldap feature.
	(ldap-delete): Enclosed call-process with `with-temp-buffer'.
	(ldap-add): Added error handling.
	(ldap-modify): Ditto.
	(ldap-delete): Ditto.

2000-06-03  OKAZAKI Tetsurou  <okazaki@be.to>

	* elmo-localdir.el (elmo-localdir-msgdb-create-as-numlist):
	Initialize local variables with `let'.  Inline a temporary
	variable for the progress percentage.  Sort `setq' to reduce
	function call in the while-loop.

	* mmelmo.el (mmelmo-get-original-buffer): Move `save-excursion'
	into the conditional branch.

2000-05-30  OKAZAKI Tetsurou  <okazaki@be.to>

	* elmo2.el (elmo-move-msgs): Replace `append' with `nconc'.
	Move a conditional out of the while-loop.

2000-05-27  Masahiro MURATA  <muse@ba2.so-net.ne.jp>

	* elmo-msgdb.el (elmo-msgdb-overview-get-entity): Use
	elmo-msgdb-overview-get-entity-by-number.
	(elmo-msgdb-overview-get-entity-by-number): Don't use catch and
	throw.

2000-05-26  OKAZAKI Tetsurou  <okazaki@be.to>

	* elmo-localdir.el (elmo-localdir-pack-number): Renamed
	the local variable for a packed number self descriptively.

2000-05-21  Masahiro MURATA  <muse@ba2.so-net.ne.jp>

	* elmo2.el (elmo-msgdb-load): Remove elmo-msgdb-overview-hashtb.
	* elmo-localdir.el (elmo-localdir-pack-number): Use
	`elmo-msgdb-overview-get-entity' instead of
	`elmo-msgdb-overview-get-entity-by-number'.
	* elmo-msgdb.el (elmo-msgdb-overview-hashtb): Removed.
	(elmo-msgdb-search-overview-entity): Removed.
	(elmo-msgdb-overview-get-entity): Change argument. Get overview entity
	by message-id or number.
	(elmo-msgdb-delete-msgs): Use `elmo-msgdb-overview-get-entity'
	instead of `elmo-msgdb-overview-get-entity-by-number'.

2000-05-20  Masahiro MURATA  <muse@ba2.so-net.ne.jp>

	* elmo-vars.el (elmo-use-overview-hashtb): New variable. If
	non-nil, use hash table for overview.
	(elmo-hash-maximum-size): New variable.
	* elmo-msgdb.el (elmo-msgdb-overview-hashtb): New variable.
	(elmo-msgdb-make-overview-hashtb): New function.
	(elmo-msgdb-clear-overview-hashtb): New function.
	(elmo-clear-hash-val): New macro.
	All other related modules are changed.

2000-05-18  Yuuichi Teranishi  <teranisi@gohome.org>

	* elmo2.el (elmo-move-msgs): If there's other message with
	same message-id, don't use cache.

2000-05-18  Nishimoto Masaki <nishimoto@gaju.org>

	* elmo-localdir.el (elmo-localdir-pack-number): Fixed problem when
	number is already packed.

2000-05-15  OKAZAKI Tetsurou  <okazaki@be.to>

	* elmo-vars.el: Doc fixes. Trim trailing whitespace.

2000-05-12  Masahiro MURATA  <muse@ba2.so-net.ne.jp>

	* elmo-vars.el (elmo-display-progress-threshold): New variable.
	All other related modules are changed.

2000-05-11  Yuuichi Teranishi  <teranisi@gohome.org>

	* elmo-msgdb.el (elmo-msgdb-sort-by-date): Fixed a problem
	of refiling failure on Maildir.

2000-05-10  Masahiro MURATA  <muse@ba2.so-net.ne.jp>

	* elmo-msgdb.el (elmo-msgdb-get-decoded-cache): get string of
	decoded mime-charset with cache.
	(elmo-msgdb-overview-entity-get-from): Ditto.
	(elmo-msgdb-overview-entity-get-subject): Ditto.
	* elmo-vars.el (elmo-use-decoded-cache): New variable.

2000-05-10  Kenichi OKADA <okada@opaopa.org>

	* elmo-utils.el (elmo-get-passwd): Set timeout of password.
	(elmo-remove-passwd): Fill password with 0 before erase.
	* elmo-vars.el (elmo-passwd-life-time): New variable.


2000-05-10  Yuuichi Teranishi  <teranisi@gohome.org>

	* elmo-cache.el (elmo-buffer-cache-add):
	Set message cache buffer as unibyte.

2000-05-07  Masahiro MURATA  <muse@ba2.so-net.ne.jp>

	* elmo-archive.el (elmo-archive-list-folders): Fix base-folder
	become nil.

2000-04-28  Yuuichi Teranishi  <teranisi@gohome.org>

	* elmo-nntp.el (elmo-nntp-list-folders): Remove progress gauge
	when display is finished.
	(elmo-nntp-msgdb-create): Ditto.
	(elmo-nntp-groups-read-response): Ditto.
	(elmo-nntp-retrieve-headers): Ditto.
	(elmo-nntp-msgdb-create-message): Ditto.
	* elmo-pop3.el (elmo-pop3-retrieve-headers): Ditto.
	(elmo-pop3-msgdb-create-message): Ditto.

2000-04-24  Yuuichi Teranishi  <teranisi@elmo.dq.isl.ntt.co.jp>

	* elmo-maildir.el (elmo-maildir-msgdb-create):
	Use `elmo-msgdb-sort-by-date'.

2000-04-20  Yuuichi Teranishi  <teranisi@gohome.org>

	* elmo2.el (elmo-read-msg-no-cache):
	Eliminated arguments after `outbuf'.
	Don't use cache even if it exists.
	(elmo-read-msg): Don't pass arguments after `outbuf' to
	`elmo-read-msg-no-cache'.

2000-04-15  Yuuichi Teranishi  <teranisi@elmo.dq.isl.ntt.co.jp>

	* elmo-archive.el (elmo-archive-list-folders):
	Use `file-name-directory' if base folder does not exist.

2000-04-14  Nishimoto Masaki <nishimoto@gaju.org>

	* elmo-archive.el (elmo-archive-list-folders): Don't use
	`file-name-directory'.

2000-04-07  Yuuichi Teranishi  <teranisi@gohome.org>

	* elmo-dop.el (elmo-dop-queue-flush): Add optional argument `force'.
	If `force' is non-nil, try flushing all operation queues.

2000-04-03  Yuuichi Teranishi  <teranisi@gohome.org>

	* elmo-pop3.el (elmo-pop3-open-connection): Enclose with
	as-binary-process.

2000-03-29  Daiki Ueno <ueno@kiss.kake.info.waseda.ac.jp>

	* elmo-util.el (elmo-display-progress): Fixed.

2000-03-27  Daiki Ueno <ueno@kiss.kake.info.waseda.ac.jp>

	* elmo-util.el (elmo-display-progress): New function.
	All other related modules are changed.

